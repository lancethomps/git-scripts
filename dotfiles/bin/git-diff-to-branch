#!/usr/bin/env bash
################################################################### SETUP ########################################################################
if ! _SCRIPT_DIR="$(get_script_dir "${BASH_SOURCE[0]}")"; then echo "Error while running: _SCRIPT_DIR=\"\$(get_script_dir \"${BASH_SOURCE[0]}\")\"" && exit 1; fi
# shellcheck disable=SC1090
if test -e "${_SCRIPT_DIR}/.git_command_defaults.sh"; then source "${_SCRIPT_DIR}/.git_command_defaults.sh"; else echo '"${_SCRIPT_DIR}/.git_command_defaults.sh" does not exist - resolved to: '"${_SCRIPT_DIR}/.git_command_defaults.sh" && exit 1; fi
##################################################################################################################################################

DEFAULT_GIT_CURRENT_BRANCH="$(git current-branch-or-commit)"
GIT_CURRENT_BRANCH="${GIT_CURRENT_BRANCH:-$DEFAULT_GIT_CURRENT_BRANCH}"
GIT_BRANCH="$1"
shift
GIT_MERGE_BASE="$(git merge-base "${GIT_CURRENT_BRANCH}" "${GIT_BRANCH}")"

if check_debug; then
  echo git diff "$@" "${GIT_MERGE_BASE}" "${GIT_CURRENT_BRANCH}"
else
  git diff "$@" "${GIT_MERGE_BASE}" "${GIT_CURRENT_BRANCH}"
fi
