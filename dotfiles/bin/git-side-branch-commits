#!/usr/bin/env bash
################################################################### SETUP ########################################################################
if ! _SCRIPT_DIR="$(get_script_dir "${BASH_SOURCE[0]}")"; then echo "Error while running: _SCRIPT_DIR=\"\$(get_script_dir \"${BASH_SOURCE[0]}\")\"" && exit 1; fi
# shellcheck source=./.common_copy.sh
source "${_SCRIPT_DIR}/.common_copy.sh" || exit 1
set -o errexit -o errtrace -o nounset
##################################################################################################################################################

function main() {
  local base_branch="${base_branch-}" curr_branch

  curr_branch="$(git current-branch)"

  if test -z "${base_branch-}"; then
    if test -n "${1-}" && [[ $1 != '-'* ]]; then
      base_branch="$1"
      shift
    else
      base_branch="origin/$(git default-branch)"
    fi
  fi

  log_and_run_no_sep git log --stat --graph --date=iso --pretty='format:%C(yellow)%h %C(cyan)%>(12)%ad %Cgreen%<(10)%aN%Cred%d %Creset%B' "$@" "${curr_branch}" "^${base_branch}"
}

main "$@"
